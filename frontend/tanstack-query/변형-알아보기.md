# ë³€í˜•(mutation) ì•Œì•„ë³´ê¸°

<div style="margin-top: 16px">
  <Badge type="info" text="Tanstack Query" />
  <Badge type="info" text="Mutation" />
</div>

ì¼ë°˜ì ìœ¼ë¡œ ë³€í˜•(mutation)ì´ëž€ ë¶€ìˆ˜ íš¨ê³¼ë¥¼ ê°–ëŠ” í•¨ìˆ˜ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë°°ì—´ì˜ `push` ë©”ì†Œë“œë¥¼ ì‚´íŽ´ë³´ë©´, ë°°ì—´ì— ê°’ì„ ì¶”ê°€í•˜ë©´ì„œ ì›ë³¸ ë°°ì—´ì„ ì§ì ‘ ë³€ê²½í•˜ëŠ” ë¶€ìˆ˜ íš¨ê³¼ê°€ ë°œìƒí•©ë‹ˆë‹¤.

```javascript
const arr = [1];
arr.push(2);

console.log(arr); // [1, 2]
```

ë°˜ë©´, ë¶ˆë³€ì„±ì„ ìœ ì§€í•˜ëŠ” ë©”ì†Œë“œë¡œëŠ” `concat` ì´ ìžˆìŠµë‹ˆë‹¤. `concat` ì€ ê°’ì„ ì¶”ê°€í•˜ì§€ë§Œ, ê¸°ì¡´ ë°°ì—´ì„ ì§ì ‘ ìˆ˜ì •í•˜ì§€ ì•Šê³  ìƒˆë¡œìš´ ë°°ì—´ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

```javascript
const arr = [1];
const newArr = arr.concat(2);

console.log(arr); //  [1]
console.log(newArr); // [1, 2]
```

ì´ë¦„ì—ì„œë„ ì•Œ ìˆ˜ ìžˆë“¯ì´, `useMutation` ì€ ì–´ë–¤ í˜•íƒœì˜ ë¶€ìˆ˜ íš¨ê³¼ë¥¼ í¬í•¨í•˜ê³  ìžˆìŠµë‹ˆë‹¤. TanStack Queryì—ì„œ ì„œë²„ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ” ë§¥ë½ì—ì„œ ë³´ë©´, **ë³€í˜•(mutation)ì€ ì„œë²„ì—ì„œ ë¶€ìˆ˜ íš¨ê³¼ë¥¼ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜**ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë°ì´í„°ë² ì´ìŠ¤ì— todoë¥¼ ìƒì„±í•˜ëŠ” ê²ƒ, ì‚¬ìš©ìžë¥¼ ë¡œê·¸ì¸ì‹œí‚¤ëŠ” ê²ƒ ë“±ì´ ë³€í˜•ì— í•´ë‹¹í•©ë‹ˆë‹¤. ë¡œê·¸ì¸ ê³¼ì •ì—ì„œëŠ” ì‚¬ìš©ìžë¥¼ ìœ„í•œ í† í°ì„ ìƒì„±í•˜ëŠ” ë¶€ìˆ˜ íš¨ê³¼ê°€ ë°œìƒí•˜ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤.

## `useQuery`ì™€ì˜ ì°¨ì´ì 

`useQuery` ëŠ” ì„ ì–¸í˜•, `useMutation` ì€ ëª…ë ¹í˜•ìž…ë‹ˆë‹¤.

ì¦‰, ëŒ€ë¶€ë¶„ì˜ ì¿¼ë¦¬(query)ëŠ” ìžë™ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤. ì˜ì¡´ì„±ì„ ì •ì˜í•˜ë©´ TanStack Queryê°€ ì¿¼ë¦¬ë¥¼ ì¦‰ì‹œ ì‹¤í–‰í•˜ê³ , í•„ìš”ì— ë”°ë¼ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì—…ë°ì´íŠ¸í•˜ë„ë¡ ê´€ë¦¬í•©ë‹ˆë‹¤. í™”ë©´ì—ì„œ ë³´ëŠ” ë°ì´í„°ë¥¼ ë°±ì—”ë“œì˜ ì‹¤ì œ ë°ì´í„°ì™€ ë™ê¸°í™”ëœ ìƒíƒœë¡œ ìœ ì§€í•˜ê³  ì‹¶ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤.

í•˜ì§€ë§Œ ë³€í˜•(mutation)ì˜ ê²½ìš°, ì´ëŸ¬í•œ ë°©ì‹ì´ ì ì ˆí•˜ì§€ ì•Šì„ ìˆ˜ë„ ìžˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë¸Œë¼ìš°ì € ì°½ì— í¬ì»¤ìŠ¤ê°€ ë§žì¶°ì§ˆ ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ í•  ì¼ì´ ìƒì„±ë˜ë©´ ì•ˆë©ë‹ˆë‹¤. ê·¸ëž˜ì„œ TanStack QueryëŠ” ë³€í˜•ì„ ìžë™ ì‹¤í–‰í•˜ëŠ” ëŒ€ì‹ , í•„ìš”í•  ë•Œ ì§ì ‘ í˜¸ì¶œí•  ìˆ˜ ìžˆëŠ” í•¨ìˆ˜ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

```jsx
function AddComment({ id }) {
  // ì•„ë¬´ê²ƒë„ ì‹¤í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤
  const addComment = useMutation({
    mutationFn: (newComment) => axios.post(`/posts/${id}/comments`, newComment),
  });

  return (
    <form
      onSubmit={(event) => {
        event.preventDefault();
        // âœ… í¼ì´ ì œì¶œë˜ë©´ mutationì´ ì‹¤í–‰ë©ë‹ˆë‹¤
        addComment.mutate(new FormData(event.currentTarget).get("comment"));
      }}
    >
      <textarea name="comment" />
      <button type="submit">Comment</button>
    </form>
  );
}
```

ë˜ ë‹¤ë¥¸ ì°¨ì´ì ì€, ë³€í˜•ì´ `useQuery` ì²˜ëŸ¼ ìƒíƒœë¥¼ ê³µìœ í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì ìž…ë‹ˆë‹¤. ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë™ì¼í•œ `useQuery` ë¥¼ í˜¸ì¶œí•˜ë©´, ë™ì¼í•œ ìºì‹œëœ ê²°ê³¼ë¥¼ ë°˜í™˜ë°›ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë³€í˜•(mutation)ì—ëŠ” í•´ë‹¹ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ë‹¤ë§Œ, TanStack Query V5ë¶€í„° [`useMutationState`](https://tanstack.com/query/v5/docs/framework/react/reference/useMutationState) í›…ì„ ì‚¬ìš©í•˜ë©´ ë³€í˜•ì˜ ìƒíƒœë¥¼ ì»´í¬ë„ŒíŠ¸ ê°„ì— ê³µìœ í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

## ë³€í˜•ì„ ì¿¼ë¦¬ì™€ ì—°ê²°í•˜ê¸°

ë³€í˜•(mutation)ì€ ì„¤ê³„ìƒ ì¿¼ë¦¬ì™€ ì§ì ‘ ì—°ê²°ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë¸”ë¡œê·¸ ê²Œì‹œë¬¼ì˜ "ì¢‹ì•„ìš”"ë¥¼ ì¶”ê°€í•˜ëŠ” ë³€í˜•ì€ í•´ë‹¹ ê²Œì‹œë¬¼ì„ ê°€ì ¸ì˜¤ëŠ” ì¿¼ë¦¬ì™€ ë³„ê°œìž…ë‹ˆë‹¤. ë³€í˜•ìœ¼ë¡œ ì¸í•œ ë³€ê²½ ì‚¬í•­ì„ ì¿¼ë¦¬ì— ë°˜ì˜í•˜ê¸° ìœ„í•´, TanStack QueryëŠ” ë‘ ê°€ì§€ ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤.

### ë¬´íš¨í™”

ì´ ë°©ë²•ì€ í™”ë©´ì„ ìµœì‹  ìƒíƒœë¡œ ìœ ì§€í•˜ëŠ” ê°€ìž¥ ê°„ë‹¨í•œ ë°©ë²•ìž…ë‹ˆë‹¤.

ì„œë²„ ìƒíƒœë¥¼ ë‹¤ë£° ë•Œ, í™”ë©´ì— í‘œì‹œë˜ëŠ” ë°ì´í„°ëŠ” í•´ë‹¹ ì‹œì ì˜ ìŠ¤ëƒ…ìƒ·ì¼ ë¿ì´ë¼ëŠ” ì ì„ ê¸°ì–µí•©ì‹œë‹¤. ë¬¼ë¡ , TanStack QueryëŠ” ë°ì´í„°ë¥¼ ìµœì‹  ìƒíƒœë¡œ ìœ ì§€í•˜ë ¤ê³  í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ë³€í˜•(mutation)ì„ í†µí•´ ì„œë²„ ìƒíƒœë¥¼ ë³€ê²½í•˜ë©´, ìºì‹œëœ ë°ì´í„°ê°€ ë” ì´ìƒ ìœ íš¨í•˜ì§€ ì•Šë‹¤ëŠ” ì‹ í˜¸ë¥¼ TanStack Queryì— ì „ë‹¬í•  ì¢‹ì€ ê¸°íšŒê°€ ë©ë‹ˆë‹¤.

ì´ë¥¼ í†µí•´ TanStack QueryëŠ” í˜„ìž¬ ì‚¬ìš© ì¤‘ì¸ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê³ , ë°ì´í„°ê°€ ê°±ì‹ ë˜ë©´ í™”ë©´ë„ ìžë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤. ê°œë°œìžëŠ” ë¬´íš¨í™”í•  ì¿¼ë¦¬ë¥¼ ì§€ì •í•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.

```javascript
const useAddComment = (id) => {
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: (newComment) => axios.post(`/posts/${id}/comments`, newComment),
    onSuccess: () => {
      // âœ… í¬ìŠ¤íŠ¸ì˜ ëŒ“ê¸€ì„ ë¬´íš¨í™”í•©ë‹ˆë‹¤
      queryClient.invalidateQueries({
        queryKey: ["posts", id, "comments"],
      });
    },
  });
};
```

ì¿¼ë¦¬ ë¬´íš¨í™”(query invalidation)ëŠ” ìƒë‹¹ížˆ ì˜ë¦¬í•˜ê²Œ ë™ìž‘í•©ë‹ˆë‹¤. ëª¨ë“  ì¿¼ë¦¬ í•„í„°ì™€ ë§ˆì°¬ê°€ì§€ë¡œ, ì¿¼ë¦¬ í‚¤ì— ëŒ€í•´ í¼ì§€ ë§¤ì¹­(fuzzy matching)ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì¦‰, íŠ¹ì • ëŒ“ê¸€ ëª©ë¡ì— ì—¬ëŸ¬ ê°œì˜ ì¿¼ë¦¬ í‚¤ê°€ ì¡´ìž¬í•˜ë”ë¼ë„, ëª¨ë‘ ë¬´íš¨í™”ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ, í˜„ìž¬ í™œì„±í™”ëœ ì¿¼ë¦¬ë§Œ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê³ , ë‚˜ë¨¸ì§€ëŠ” ì˜¤ëž˜ëœ(stale) ìƒíƒœë¡œ í‘œì‹œë©ë‹ˆë‹¤. ì´í›„ í•„ìš”í•  ë•Œ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê²Œ ë©ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, ëŒ“ê¸€ì„ ì •ë ¬í•˜ëŠ” ì—¬ëŸ¬ ì˜µì…˜ì´ ìžˆê³ , ìƒˆë¡œìš´ ëŒ“ê¸€ì´ ì¶”ê°€ë˜ëŠ” ìƒí™©ì„ ê°€ì •í•´ ë´…ì‹œë‹¤. ì´ë•Œ, ìºì‹œì—ëŠ” ë‘ ê°œì˜ ëŒ“ê¸€ ì¿¼ë¦¬ê°€ ì €ìž¥ë˜ì–´ ìžˆìŠµë‹ˆë‹¤.

```javascript
['posts', 5, 'comments', { sortBy: ['date', 'asc'] }
['posts', 5, 'comments', { sortBy: ['author', 'desc'] }
```

ë‘˜ ì¤‘ í•˜ë‚˜ë§Œ í™”ë©´ì— í‘œì‹œí•˜ê³  ìžˆë‹¤ë©´, `invalidateQueries` ëŠ” í•´ë‹¹ ì¿¼ë¦¬ë§Œ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê³ , ë‚˜ë¨¸ì§€ëŠ” ì˜¤ëž˜ëœ(stale) ìƒíƒœë¡œ í‘œì‹œí•˜ì—¬ í•„ìš”í•  ë•Œ ë‹¤ì‹œ ê°€ì ¸ì˜¤ë„ë¡ ì²˜ë¦¬í•©ë‹ˆë‹¤.

### ì§ì ‘ ì—…ë°ì´íŠ¸

ë³€í˜•(mutation) ì´í›„ í•„ìš”í•œ ë°ì´í„°ê°€ ì´ë¯¸ ë°˜í™˜ëœ ê²½ìš°, ë°ì´í„°ë¥¼ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¬ í•„ìš”ê°€ ì—†ì„ ìˆ˜ë„ ìžˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë¸”ë¡œê·¸ ê²Œì‹œë¬¼ì˜ ì œëª©ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ë³€í˜•ì´ ìžˆê³ , ë°±ì—”ë“œê°€ ì „ì²´ ë¸”ë¡œê·¸ ê²Œì‹œë¬¼ì„ ì‘ë‹µìœ¼ë¡œ ë°˜í™˜í•œë‹¤ê³  ê°€ì •í•´ ë´…ì‹œë‹¤. ì´ ê²½ìš°, `setQueryData` ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¿¼ë¦¬ ìºì‹œë¥¼ ì§ì ‘ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

```javascript
const useUpdateTitle = (id) => {
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: (newTitle) =>
      axios
        .patch(`/posts/${id}`, { title: newTitle })
        .then((response) => response.data),
    // ðŸ’¡ ë³€í˜•(mutation)ì˜ ì‘ë‹µì´ onSucessë¡œ ì „ë‹¬ë©ë‹ˆë‹¤
    onSuccess: (newPost) => {
      // âœ… ì§ì ‘ ë³€ê²½ëœ í¬ìŠ¤íŠ¸ë¡œ ì—…ë°ì´íŠ¸ í•©ë‹ˆë‹¤
      queryClient.setQueryData(["posts", id], newPost);
    },
  });
};
```

`setQueryData` ë¥¼ í†µí•´ ìºì‹œì— ë°ì´í„°ë¥¼ ì§ì ‘ ìˆ˜ì •í•˜ë©´, ë§ˆì¹˜ ë°±ì—”ë“œì—ì„œ ë°˜í™˜ëœ ê²ƒì²˜ëŸ¼ ë™ìž‘í•˜ë©°, í•´ë‹¹ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ë©ë‹ˆë‹¤.

:::tip
ê°œì¸ì ìœ¼ë¡œëŠ” ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ì¿¼ë¦¬ ë¬´íš¨í™”ë¥¼ ìš°ì„ ì ìœ¼ë¡œ ê³ ë ¤í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤. ë¬¼ë¡  ì‚¬ìš© ì‚¬ë¡€ì— ë”°ë¼ ë‹¤ë¥´ì§€ë§Œ, ì§ì ‘ ì—…ë°ì´íŠ¸ê°€ ì‹ ë¢°ì„± ìžˆê²Œ ë™ìž‘í•˜ë ¤ë©´ í”„ë¡ íŠ¸ì—”ë“œì— ë” ë§Žì€ ì½”ë“œê°€ í•„ìš”í•˜ë©°, ì–´ëŠ ì •ë„ ë°±ì—”ë“œì˜ ë¡œì§ì„ ì¤‘ë³µí•´ì„œ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ë§ŽìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, ì •ë ¬ëœ ëª©ë¡ì„ ì§ì ‘ ì—…ë°ì´íŠ¸í•˜ëŠ” ê²ƒì€ ì‰½ì§€ ì•ŠìŠµë‹ˆë‹¤. ì—…ë°ì´íŠ¸ëœ í•­ëª©ì´ ëª©ë¡ ë‚´ì—ì„œ ìœ„ì¹˜ê°€ ë³€ê²½ë  ê°€ëŠ¥ì„±ì´ ìžˆê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. ë”°ë¼ì„œ ëª©ë¡ ì „ì²´ë¥¼ ë¬´íš¨í™”í•˜ëŠ” ê²ƒì´ ë” ì•ˆì „í•œ ì ‘ê·¼ë²•ì´ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
:::

## í”í•œ ê°“ì± 

### ëŒ€ê¸°ì¤‘ì¸ í”„ë¡œë¯¸ìŠ¤

ë³€í˜•(mutation) ì½œë°±ì—ì„œ ë°˜í™˜ëœ í”„ë¡œë¯¸ìŠ¤ëŠ” TanStack Queryì— ì˜í•´ ëŒ€ê¸°(awaited) ìƒíƒœê°€ ë©ë‹ˆë‹¤. `invalidateQueries` ëŠ” í”„ë¡œë¯¸ìŠ¤ë¥¼ ë°˜í™˜í•˜ë¯€ë¡œ, ì´ í”„ë¡œë¯¸ìŠ¤ë¥¼ ì½œë°±ì—ì„œ ë°˜í™˜í•˜ë©´ ì¿¼ë¦¬ ë¬´íš¨í™”ê°€ ì™„ë£Œë  ë•Œê¹Œì§€ ëŒ€ê¸°í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

```javascript
{
  // ðŸŽ‰ ì¿¼ë¦¬ ë¬´íš¨í™”ê°€ ëë‚  ë•Œ ê¹Œì§€ ëŒ€ê¸°í•©ë‹ˆë‹¤
  onSuccess: () => {
    return queryClient.invalidateQueries({
      queryKey: ["posts", id, "comments"],
    });
  };
}
{
  // ðŸš€ ëŒ€ê¸°í•˜ì§€ ì•Šê³  ì‹¤í–‰ë§Œ í•©ë‹ˆë‹¤
  onSuccess: () => {
    queryClient.invalidateQueries({
      queryKey: ["posts", id, "comments"],
    });
  };
}
```

### `mutate` ì™€ `mutateAsync`

`useMutation` ì€ `mutate` ì™€ `mutateAsync` í•¨ìˆ˜ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

`mutate` ëŠ” ë°˜í™˜ê°’ì´ ì—†ëŠ” ë°˜ë©´, `mutateAsync` ëŠ” ë³€í˜• ê²°ê³¼ë¥¼ í¬í•¨í•˜ëŠ” í”„ë¡œë¯¸ìŠ¤ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ë³€í˜• ì‘ë‹µì— ì§ì ‘ ì ‘ê·¼í•´ì•¼ í•  ê²½ìš° `mutateAsync` ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ, ëŒ€ë¶€ë¶„ì˜ ê²½ìš° mutateë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë” ë°”ëžŒì§í•˜ë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤. ì½œë°±ì„ í†µí•´ `data` ë‚˜ `error` ì— ì ‘ê·¼í•  ìˆ˜ ìžˆìœ¼ë©°, ë³„ë„ë¡œ ì˜¤ë¥˜ë¥¼ ì²˜ë¦¬í•  í•„ìš”ê°€ ì—†ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. ë°˜ë©´, `mutateAsync` ëŠ” í”„ë¡œë¯¸ìŠ¤ì˜ ì œì–´ê¶Œì„ ê°œë°œìžì—ê²Œ ë„˜ê¸°ë¯€ë¡œ, ì§ì ‘ ì˜¤ë¥˜ë¥¼ ì²˜ë¦¬í•˜ì§€ ì•Šìœ¼ë©´ [ì²˜ë¦¬ë˜ì§€ ì•Šì€ í”„ë¡œë¯¸ìŠ¤ ê±°ë¶€(unhandled promise rejection)](https://stackoverflow.com/questions/40500490/what-is-an-unhandled-promise-rejection)ê°€ ë°œìƒí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

```javascript
const onSubmit = () => {
  // âœ… onSuccessë¥¼ í†µí•´ ì‘ë‹µì— ì ‘ê·¼í•©ë‹ˆë‹¤
  myMutation.mutate(someData, {
    onSuccess: (data) => history.push(data.url),
  });
};

const onSubmit = async () => {
  // ðŸš¨ ìž‘ë™í•˜ì§€ë§Œ, ì—ëŸ¬ ì²˜ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤
  const data = await myMutation.mutateAsync(someData);
  history.push(data.url);
};

const onSubmit = async () => {
  // ðŸ˜• ë¬¸ì œëŠ” ì—†ëŠ” ë°©ë²•ì´ì§€ë§Œ ìž¥í™©í•©ë‹ˆë‹¤
  try {
    const data = await myMutation.mutateAsync(someData);
    history.push(data.url);
  } catch (error) {
    // ì•„ë¬´ê²ƒë„ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
  }
};
```

`mutate` ë¥¼ ì‚¬ìš©í•˜ë©´ TanStack Queryê°€ ë‚´ë¶€ì ìœ¼ë¡œ ì˜¤ë¥˜ë¥¼ í¬ì°©í•˜ê³  ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì—, ë³„ë„ë¡œ ì˜¤ë¥˜ë¥¼ ì‹ ê²½ ì“¸ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. ì‹¤ì œë¡œ `mutateAsync().catch(noop)` ë°©ì‹ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ ìžˆìŠµë‹ˆë‹¤.

ë°˜ë©´, `mutateAsync` ê°€ ìœ ìš©í•œ ê²½ìš°ëŠ” í”„ë¡œë¯¸ìŠ¤ê°€ í•„ìš”í•œ ìƒí™©ìž…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì—¬ëŸ¬ ë³€í˜•(mutation)ì„ ë™ì‹œì— ì‹¤í–‰í•˜ê³  ëª¨ë“  ìž‘ì—…ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•˜ê±°ë‚˜, ì½œë°± ì¤‘ì²©ìœ¼ë¡œ ì¸í•œ ì½œë°± ì§€ì˜¥ì„ í”¼í•˜ê¸° ìœ„í•´ ì¢…ì†ì ì¸ ë³€í˜•ì„ ì²´ì¸ í˜•íƒœë¡œ ì‹¤í–‰í•´ì•¼ í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

### ì‹¤í–‰ë˜ì§€ ì•Šì„ ìˆ˜ ìžˆëŠ” ì½œë°±

`useMutation` ê³¼ `mutate` ëª¨ë‘ ì½œë°±ì„ ì„¤ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì¤‘ìš”í•œ ì ì€ `useMutation` ì˜ ì½œë°±ì´ `mutate` ì˜ ì½œë°±ë³´ë‹¤ ë¨¼ì € ì‹¤í–‰ëœë‹¤ëŠ” ê²ƒìž…ë‹ˆë‹¤.

ë˜í•œ, ë³€í˜•(mutation)ì´ ì™„ë£Œë˜ê¸° ì „ì— ì»´í¬ë„ŒíŠ¸ê°€ ì–¸ë§ˆìš´íŠ¸ë˜ë©´ `mutate` ì˜ ì½œë°±ì´ ì‹¤í–‰ë˜ì§€ ì•Šì„ ìˆ˜ë„ ìžˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, ì½œë°±ì—ì„œ ê´€ì‹¬ì‚¬ë¥¼ ë¶„ë¦¬í•˜ëŠ” ê²ƒì´ ì¢‹ì€ ì‹¤ì²œ ë°©ë²•ìž…ë‹ˆë‹¤.

- ì¿¼ë¦¬ ë¬´íš¨í™”ì™€ ê°™ì´ ë°˜ë“œì‹œ í•„ìš”í•œ ìž‘ì—…ì€ `useMutation` ì½œë°±ì— ìž‘ì„±í•©ë‹ˆë‹¤.
- ë¦¬ë‹¤ì´ë ‰ì…˜ì´ë‚˜ í† ìŠ¤íŠ¸ ì•Œë¦¼ê³¼ ê°™ì€ UI ê´€ë ¨ ìž‘ì—…ì€ `mutate` ì½œë°±ì— ìž‘ì„±í•©ë‹ˆë‹¤. ë³€í˜•ì´ ì™„ë£Œë˜ê¸° ì „ì— ì‚¬ìš©ìžê°€ í™”ë©´ì„ ë²—ì–´ë‚˜ë©´ ì´ëŸ¬í•œ ìž‘ì—…ì€ ì˜ë„ì ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•Šì•„ì•¼ í•˜ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤.

ì´ëŸ¬í•œ ë¶„ë¦¬ëŠ” `useMutation` ì„ ì»¤ìŠ¤í…€ í›…ì—ì„œ ì‚¬ìš©í•  ë•Œ íŠ¹ížˆ ìœ ìš©í•©ë‹ˆë‹¤. **ì¿¼ë¦¬ ê´€ë ¨ ë¡œì§ì€ ì»¤ìŠ¤í…€ í›…ì—ì„œ ì²˜ë¦¬, UI ê´€ë ¨ ìž‘ì—…ì€ UIì—ì„œ ì²˜ë¦¬**í•  ìˆ˜ ìžˆê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ì»¤ìŠ¤í…€ í›…ì´ ë”ìš± ìž¬ì‚¬ìš© ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤. UIì™€ì˜ ìƒí˜¸ìž‘ìš© ë°©ì‹ì€ ìƒí™©ì— ë”°ë¼ ë‹¬ë¼ì§€ì§€ë§Œ, ë¬´íš¨í™” ë¡œì§ì€ ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ë™ì¼í•˜ê²Œ ìœ ì§€ë˜ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤.

```jsx
const useUpdateTodo = () =>
  useMutation({
    mutationFn: updateTodo,
    // âœ… í•­ìƒ todo ëª©ë¡ì„ ë¬´íš¨í™” í•©ë‹ˆë‹¤
    onSuccess: () => {
      queryClient.invalidateQueries({
        queryKey: ["todos", "list"],
      });
    },
  });

function Todo() {
  const updateTodo = useUpdateTodo();

  return (
    <Button
      onClick={() => {
        updateTodo.mutate(
          { title: "new title" },
          // âœ… ë³€í˜•(mutation)ì´ ëë‚œ í›„ ìƒì„¸ íŽ˜ì´ì§€ì— ìœ„ì¹˜í•´ìžˆì„ ë•Œì—ë§Œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•©ë‹ˆë‹¤
          { onSuccess: () => history.push("/todos") }
        );
      }}
    >
      ìˆ˜ì •í•˜ê¸°
    </Button>
  );
}
```
